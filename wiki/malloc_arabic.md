<!--
Meta Description: # malloc في لغة C: تخصيص الذاكرة الديناميكية ## ملخص `malloc` هي دالة في لغة البرمجة C تُستخدم لتخصيص مساحة من الذاكرة بشكل ديناميكي خلال وقت التشغيل....
Meta Keywords: الذاكرة, malloc, تخصيص, int, array
-->

# malloc في لغة C: تخصيص الذاكرة الديناميكية

## ملخص
`malloc` هي دالة في لغة البرمجة C تُستخدم لتخصيص مساحة من الذاكرة بشكل ديناميكي خلال وقت التشغيل. تُعتبر هذه الدالة جزءًا من مكتبة C القياسية، وتساعد المبرمجين في إدارة الذاكرة بفعالية.

## الوثائق
### الغرض
تُستخدم دالة `malloc` (اختصار لـ "memory allocation") لتخصيص كتلة من الذاكرة بحجم محدد، مما يتيح للمستخدم القدرة على تخصيص الذاكرة أثناء تنفيذ البرنامج بدلاً من تخصيصها مسبقًا.

### الاستخدام
تُستخدم `malloc` بالطريقة التالية:
```c
#include <stdlib.h>

void* malloc(size_t size);
```
- **المدخلات**: 
  - `size`: حجم الذاكرة المطلوب تخصيصها بالبايت.
  
- **الإخراج**:
  - تُعيد الدالة مؤشرًا إلى بداية الكتلة المخصصة من الذاكرة، أو `NULL` إذا فشل التخصيص.

### التفاصيل
- يجب أن تُحرر الذاكرة المخصصة باستخدام `free` بعد الانتهاء من استخدامها لتجنب تسرب الذاكرة.
- لا تضمن `malloc` أن تكون الذاكرة المخصصة مُهيأة (أي تحتوي على قيم صفرية).

## أمثلة
### مثال 1: تخصيص مصفوفة من الأعداد الصحيحة
```c
#include <stdio.h>
#include <stdlib.h>

int main() {
    int* array;
    size_t size = 5;

    // تخصيص الذاكرة لمصفوفة من 5 أعداد صحيحة
    array = (int*)malloc(size * sizeof(int));

    if (array == NULL) {
        printf("فشل تخصيص الذاكرة\n");
        return 1;
    }

    // استخدام المصفوفة
    for (size_t i = 0; i < size; i++) {
        array[i] = i * 10;
        printf("%d ", array[i]);
    }

    // تحرير الذاكرة
    free(array);
    return 0;
}
```

### مثال 2: تخصيص ذاكرة لكائن هيكلي
```c
#include <stdio.h>
#include <stdlib.h>

typedef struct {
    char name[50];
    int age;
} Person;

int main() {
    Person* p = (Person*)malloc(sizeof(Person));

    if (p == NULL) {
        printf("فشل تخصيص الذاكرة\n");
        return 1;
    }

    // استخدام الهيكل
    snprintf(p->name, sizeof(p->name), "أحمد");
    p->age = 30;
    printf("الاسم: %s, العمر: %d\n", p->name, p->age);

    // تحرير الذاكرة
    free(p);
    return 0;
}
```

## الشرح
### الأخطاء الشائعة
1. **عدم التحقق من `NULL`**: من المهم التحقق مما إذا كانت `malloc` قد أعادت `NULL`، مما يشير إلى فشل التخصيص.
2. **عدم تحرير الذاكرة**: إذا لم يتم استخدام `free` لتحرير الذاكرة المخصصة، سيؤدي ذلك إلى تسرب الذاكرة.
3. **تجاهل نوع البيانات**: يجب تحويل المؤشر الناتج من `malloc` إلى النوع المناسب، مثل `(int*)` أو `(Person*)`.

### ملاحظات إضافية
- يمكن استخدام `calloc` لتخصيص الذاكرة مع تهيئة القيم إلى صفر.
- يجب أن تكون دالة `malloc` متوافقة مع أحجام البيانات على النظام المُستخدم.

## ملخص جملة واحدة
`malloc` هي دالة في C تُستخدم لتخصيص الذاكرة الديناميكية، وتوفر للمبرمجين مرونة في إدارة الذاكرة خلال وقت التشغيل.