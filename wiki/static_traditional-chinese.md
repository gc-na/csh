<!--
Meta Description: # C語言中的「static」關鍵字：揭開靜態變數的神秘面紗 ## 概述 在C語言中，「static」關鍵字用於控制變數和函數的存儲類型及其作用域，主要用於定義靜態變數和靜態函數。這個關鍵字的使用能夠影響變數的生命週期和可見性，是理解C語言的重要概念。 ## 文檔說明 ### 目的 「static」...
Meta Keywords: static, void, int, countcalls, count
-->

# C語言中的「static」關鍵字：揭開靜態變數的神秘面紗

## 概述
在C語言中，「static」關鍵字用於控制變數和函數的存儲類型及其作用域，主要用於定義靜態變數和靜態函數。這個關鍵字的使用能夠影響變數的生命週期和可見性，是理解C語言的重要概念。

## 文檔說明
### 目的
「static」關鍵字的主要目的是為了保留變數的值在多次函數調用之間，並且限制變數和函數的可見性，確保它們不會被外部程式訪問。

### 用法
- **靜態變數**：當在函數內部聲明變數為靜態時，該變數的生命週期會持續到程式的結束，而不是在每次函數調用後被銷毀。靜態變數只會被初始化一次。
  
  ```c
  void function() {
      static int count = 0; // 靜態變數
      count++;
      printf("%d\n", count);
  }
  ```

- **靜態函數**：當函數被聲明為靜態時，該函數只能在定義它的檔案內部使用，無法被其他檔案訪問。
  
  ```c
  static void helperFunction() {
      // 只能在此檔案內部調用
  }
  ```

### 詳細說明
靜態變數和靜態函數的使用通常在以下情況下是最有利的：
1. **變數的持久性**：靜態變數在多次調用過程中保持其值，這對於計算累積值或狀態資訊特別有用。
2. **封裝**：靜態函數能夠防止命名衝突，特別是在大型專案中，避免不同檔案中同名函數的衝突。

## 範例
以下是靜態變數和靜態函數的基本示例：

### 靜態變數範例
```c
#include <stdio.h>

void countCalls() {
    static int callCount = 0; // 初始化一次
    callCount++;
    printf("函數被調用次數: %d\n", callCount);
}

int main() {
    countCalls(); // 輸出: 1
    countCalls(); // 輸出: 2
    countCalls(); // 輸出: 3
    return 0;
}
```

### 靜態函數範例
```c
#include <stdio.h>

static void privateFunction() {
    printf("這是一個靜態函數，只能在此檔案中調用。\n");
}

void publicFunction() {
    privateFunction(); // 可以調用靜態函數
}

int main() {
    publicFunction(); // 輸出: 這是一個靜態函數，只能在此檔案中調用。
    // privateFunction(); // 錯誤：無法在此處調用靜態函數
    return 0;
}
```

## 說明
使用「static」關鍵字時需注意以下幾點：
- 靜態變數的初始值默認為0，因此如果不賦值，靜態變數會自動初始化。
- 靜態函數無法被其他檔案引用，這可能會對某些需要跨檔案訪問的情況造成限制。
- 靜態變數在多線程環境中需謹慎使用，以避免競爭條件和不一致的狀態。

## 一句總結
在C語言中，「static」關鍵字用於定義靜態變數和靜態函數，能夠控制變數的生命週期及函數的作用域。