<!--
Meta Description: # دالة ftell في لغة C: الاستخدامات والمزايا ## ملخص تُستخدم دالة `ftell` في لغة C لتحديد موقع مؤشر الملف الحالي في ملف مفتوح. تُعتبر هذه الدالة مفيدة ...
Meta Keywords: file, ftell, الملف, ملف, position
-->

# دالة ftell في لغة C: الاستخدامات والمزايا

## ملخص
تُستخدم دالة `ftell` في لغة C لتحديد موقع مؤشر الملف الحالي في ملف مفتوح. تُعتبر هذه الدالة مفيدة في العديد من السيناريوهات، مثل إدارة الملفات أو عند العمل مع البيانات الثنائية.

## الوثائق
### الغرض
تساعد دالة `ftell` في معرفة الموضع الحالي لمؤشر القراءة أو الكتابة في ملف، حيث يتم إرجاع عدد البايتات من بداية الملف إلى الموضع الحالي.

### الاستخدام
```c
#include <stdio.h>

long ftell(FILE *stream);
```

- **المعطيات**: 
  - `stream`: مؤشر إلى ملف مفتوح من نوع `FILE`.
  
- **القيمة المرجعة**: 
  - ترجع `ftell` قيمة من نوع `long` تمثل موضع المؤشر في الملف. إذا حدث خطأ، ترجع `-1` وتُضبط متغير الخطأ `errno`.

### التفاصيل
تُستخدم `ftell` عادةً بعد فتح ملف باستخدام `fopen`، وتكون مفيدة في تحديد الموضع الحالي قبل إجراء عمليات القراءة أو الكتابة. يجب التأكد من أن الملف مفتوح في وضع يسمح بذلك (مثل `r`, `w`, أو `a`).

## أمثلة
### مثال 1: استخدام ftell مع ملف نصي
```c
#include <stdio.h>

int main() {
    FILE *file = fopen("example.txt", "r");
    if (file == NULL) {
        perror("Error opening file");
        return -1;
    }

    fseek(file, 10, SEEK_SET); // الانتقال إلى الموضع 10
    long position = ftell(file);
    printf("Current position: %ld\n", position); // سيطبع 10

    fclose(file);
    return 0;
}
```

### مثال 2: استخدام ftell مع ملف ثنائي
```c
#include <stdio.h>

int main() {
    FILE *file = fopen("example.bin", "wb");
    if (file == NULL) {
        perror("Error opening file");
        return -1;
    }

    fwrite("Hello", sizeof(char), 5, file);
    long position = ftell(file);
    printf("Current position: %ld\n", position); // سيطبع 5

    fclose(file);
    return 0;
}
```

## الشرح
### الأخطاء الشائعة
- **فتح الملف في وضع غير مناسب**: إذا كان الملف مفتوحًا في وضع قراءة فقط، ستفشل أي محاولة للكتابة، مما قد يؤدي إلى نتائج غير متوقعة.
- **عدم التحقق من القيمة المرجعة**: يجب دائمًا التحقق مما إذا كانت القيمة المرجعة من `ftell` تساوي `-1`، مما يشير إلى حدوث خطأ في تحديد الموضع.
- **استخدام مؤشر مغلق**: إذا تمت محاولة استخدام `ftell` على ملف مغلق، فستكون النتيجة غير معروفة.

## ملخص بخط واحد
تُستخدم دالة `ftell` في لغة C لتحديد موضع مؤشر الملف الحالي، مما يساعد في إدارة الملفات بشكل فعال.