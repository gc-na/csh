<!--
Meta Description: # C言語の「realloc」関数の使い方と注意点 ## 概要 C言語の「realloc」関数は、動的メモリの再割り当てを行うための標準ライブラリ関数です。この関数を使用することで、既存のメモリブロックのサイズを変更することができます。 ## ドキュメンテーション ### 目的 `realloc`関...
Meta Keywords: realloc, int, arr, new_arr, ptr
-->

# C言語の「realloc」関数の使い方と注意点

## 概要
C言語の「realloc」関数は、動的メモリの再割り当てを行うための標準ライブラリ関数です。この関数を使用することで、既存のメモリブロックのサイズを変更することができます。

## ドキュメンテーション
### 目的
`realloc`関数は、以前に`malloc`または`calloc`で割り当てられたメモリブロックのサイズを変更するために使用されます。新しいサイズが大きい場合は、追加のメモリが割り当てられ、データが移動されることがあります。

### 使用法
```c
#include <stdlib.h>

void *realloc(void *ptr, size_t new_size);
```

- `ptr`: 変更したいメモリブロックのポインタ。
- `new_size`: 新しいサイズ（バイト単位）。

### 詳細
- `ptr`がNULLの場合、`realloc`は新しいメモリブロックを割り当て、ポインタを返します。
- `new_size`が0の場合、`realloc`は`free(ptr)`を呼び出し、NULLを返します。
- メモリの再割り当てが成功すると、新しいメモリブロックのポインタが返されます。失敗した場合はNULLが返され、元のメモリブロックは解放されません。
- 新しいメモリブロックのサイズが元のサイズより大きい場合、元のメモリブロックのデータは保持されますが、新しく追加されたメモリは未初期化です。

## 例
### 基本的な使用例
```c
#include <stdio.h>
#include <stdlib.h>

int main() {
    int *arr = malloc(5 * sizeof(int));
    if (arr == NULL) {
        return 1; // メモリ割り当て失敗
    }

    // 配列に値を代入
    for (int i = 0; i < 5; i++) {
        arr[i] = i + 1;
    }

    // メモリサイズを変更
    int *new_arr = realloc(arr, 10 * sizeof(int));
    if (new_arr == NULL) {
        free(arr); // メモリ割り当て失敗時に元のメモリを解放
        return 1;
    }

    // 新しいメモリブロックに値を代入
    for (int i = 5; i < 10; i++) {
        new_arr[i] = i + 1;
    }

    // 値を表示
    for (int i = 0; i < 10; i++) {
        printf("%d ", new_arr[i]);
    }
    
    // メモリを解放
    free(new_arr);
    return 0;
}
```

## 説明
- `realloc`を使用する際の一般的な落とし穴は、メモリの再割り当てに失敗する可能性があることです。この場合、元のポインタは無効になり、データが失われるリスクがあります。
- 常に`realloc`の戻り値をチェックし、必要に応じて元のポインタを解放することを忘れないでください。
- 新しいサイズが大きい場合、未初期化の領域が生じることに注意してください。

## 一行の要約
C言語の`realloc`関数は、動的メモリブロックのサイズを変更し、必要に応じてデータを保持するための重要なメモリ管理関数です。